# Netlify configuration for RAB Booking Flutter Web App

[build]
  # Build command for Flutter web
  command = "flutter build web --release --web-renderer canvaskit"
  # Publish directory (Flutter web build output)
  publish = "build/web"

[build.environment]
  # Flutter channel
  FLUTTER_CHANNEL = "stable"
  # Node.js version (required for build tools)
  NODE_VERSION = "18"

[[redirects]]
  # SPA redirect - all routes return index.html
  from = "/*"
  to = "/index.html"
  status = 200
  force = false

[[headers]]
  # Security headers for all routes
  for = "/*"
  [headers.values]
    X-Frame-Options = "SAMEORIGIN"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"

[[headers]]
  # Cache assets for 1 year
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  # Cache images for 30 days
  for = "/*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.png"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "/*.svg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  # No cache for index.html
  for = "/index.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  # Allow embed routes to be embedded in iframes
  for = "/embed/*"
  [headers.values]
    X-Frame-Options = "ALLOWALL"
    Content-Security-Policy = "frame-ancestors *"
